@page "/activiteit/geschiedenis"
@using ModelLibrary.Models
@using ModelLibrary.Dto
@using Newtonsoft.Json
@using Components.Pages.Bencher
@inject HttpClient Http
@inject NavigationManager NavigationManager
@rendermode InteractiveServer
@inject IDialogService DialogService
@inject AuthService auth

<PageTitle>Activiteiten geschiedenis</PageTitle>


@if (currentUserId == currentManagerUserId.ToString() || rol == "admin" || rol == "manager")
{
    <MudText Typo="Typo.h6">Enter Bench ID:</MudText>

    <MudNumericField @bind-Value="@BenchId" Label="Bench ID" Variant="Variant.Outlined" HideSpinButtons />

    <MudButton OnClick="@LoadData" Color="Color.Primary">Load Data</MudButton>
}


@if (occupationHistories.Any())
{
    <MudTable Items="@occupationHistories" Dense="true" Hover="true" Striped="true">
        <ToolBarContent>
            <MudText Typo="Typo.h6">Occupation Histories</MudText>
        </ToolBarContent>
        <HeaderContent>
            <MudTh>Activiteit</MudTh>
            <MudTh>Start Date</MudTh>
            <MudTh>End Date</MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="Occupation Type">@context.OccupationType</MudTd>
                <MudTd DataLabel="Start Date">@context.StartDate.ToString("dd-MM-yyyy")</MudTd>
                <MudTd DataLabel="End Date">@context.EndDate?.ToString("dd-MM-yyyy")</MudTd>
                <MudTd>
                    <MudIconButton Icon="@Icons.Filled.Edit" OnClick="@(e => EditRecord(context))" />
                </MudTd>
            </RowTemplate>
            <PagerContent>
                <MudTablePager PageSizeOptions="new int[]{5, 10, 15}" RowsPerPageString="Rijen per pagina" />
            </PagerContent>
        </MudTable>
}
else
{
    <MudAlert Class="mt-3" Severity="Severity.Info" ContentAlignment="HorizontalAlignment.Center">
        Je hebt nog geen activiteitengeschiedenis, of je staat momenteel niet op de bench.
    </MudAlert>
}


